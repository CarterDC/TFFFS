{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Tutorials For my Future Forgetful Self","text":"<p>Mostly testing mkdocs + material to write personal guides about home server set up ( in order not to have to re-discover the wheel every few years when it's time re-install ).</p>"},{"location":"#content","title":"Content","text":""},{"location":"#material-for-mkdocs","title":"Material for Mkdocs","text":"<p>Some documentation about the documentation system itself. TODO : move to own file at some point, along with cheat_sheet ? </p>"},{"location":"#links","title":"Links","text":"<ul> <li>Personnal Cheat Sheet Syntax examples </li> <li>Markdown Documentation</li> <li>Material Documentation</li> <li>James Willet's Tutorial (includes github actions for auto publish on project pages)</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs/            # Project Folder\n\u251c\u2500\u2500 .github\n\u2502   \u2514\u2500\u2500 worflows\n\u2502       \u2514\u2500\u2500 ci.yml # Continuous Integration : auto-deploy to GitHub Pages on push request\n\u251c\u2500\u2500 docs/\n\u2502   \u251c\u2500\u2500 styles/\n\u2502   \u2502   \u2514\u2500\u2500 extra.css\n\u2502   \u251c\u2500\u2500 index.md   # This page\n\u2502   \u251c\u2500\u2500 cheat_sheet.md\n\u2502   \u2514\u2500\u2500 ... \n\u251c\u2500\u2500 .gitignore     # /!\\ don't include .github/workflow in the ignore list !!!\n\u2514\u2500\u2500 mkdocs.yml\n</code></pre>"},{"location":"#current-yaml","title":"Current yaml","text":"yaml<pre><code>site_name: Doc perso\ntheme:\n  name: material\n  logo: assets/lemur.jpg\n  font:\n    text: Inter\n    code: Fira Code\n  icon:\n    annotation: material/information\n  palette:\n    # Dark Mode\n    - scheme: slate\n      toggle:\n        icon: material/weather-sunny\n        name: Dark mode\n      primary: indigo\n      accent: amber\n\n    # Light Mode\n    - scheme: default\n      toggle:\n        icon: material/weather-night\n        name: Light mode\n      primary: blue\n      accent: deep orange\n  features:\n    - navigation.tabs\n    - navigation.sections\n    - navigation.top\n    #- toc.integrate\n    - content.code.annotate\n    - content.code.copy\nextra_css:\n  - styles/extra.css # actually located in docs/styles/\nmarkdown_extensions:\n  - attr_list\n  - md_in_html\n  - admonition\n  - pymdownx.details      \n  - pymdownx.superfences  \n  - pymdownx.highlight:\n      anchor_linenums: true\n      line_spans: __span\n      pygments_lang_class: true\n  - pymdownx.inlinehilite\n  - pymdownx.snippets\n\n  #- pymdownx.snippets:\n  #    auto_append:\n  #      - includes/abbreviations.md\n\nnav:\n  - Home: index.md\n  - Home Server Setup:\n    - Intro: homeserver/index.md\n    - SSH: homeserver/ssh.md\n    - Samba: homeserver/samba.md\n  - Helpers:\n    - Pattern: pattern-fr.md\n    - Cheat Sheet: cheat_sheet.md\n    - Other Tests: test.md\n</code></pre>"},{"location":"cheat_sheet/","title":"Markdown Cheatsheet","text":"<p>I haven't used markdown in quite some time, And now I have MkDocs / MkDocs-Material.</p> <p>Let's see what we can do with these new toys.</p>"},{"location":"cheat_sheet/#1-headings","title":"1. Headings","text":""},{"location":"cheat_sheet/#syntax","title":"Syntax:","text":"<pre><code># Heading 1    \n## Heading 2  \n### Heading 3\n</code></pre>"},{"location":"cheat_sheet/#output","title":"Output:","text":"<p>Note</p> <p>This is an image ; output of a level 1 heading at this point would f. up the table of content</p> <p></p>"},{"location":"cheat_sheet/#2-line-break","title":"2. Line Break","text":""},{"location":"cheat_sheet/#syntax_1","title":"Syntax:","text":"<ul> <li>Using two spaces before return to force  a new line.  </li> <li>Using explicit <code>&lt;br&gt;</code> tag to force a new line.  </li> </ul>"},{"location":"cheat_sheet/#output_1","title":"Output:","text":"<ul> <li>Using two spaces before return to force   a new line.  </li> <li>Using explicit <code>&lt;br&gt;</code> tag to force  a new line.  </li> </ul>"},{"location":"cheat_sheet/#3-bold-italic-text","title":"3. Bold &amp; Italic Text","text":""},{"location":"cheat_sheet/#syntax_2","title":"Syntax:","text":"<ul> <li><code>**Bold text**</code> </li> <li><code>*Italic text*</code> </li> <li><code>***Bold and Italic***</code></li> </ul>"},{"location":"cheat_sheet/#output_2","title":"Output:","text":"<ul> <li>Bold text </li> <li>Italic text </li> <li>Bold and Italic </li> </ul>"},{"location":"cheat_sheet/#4-lists","title":"4. Lists","text":""},{"location":"cheat_sheet/#unordered-lists","title":"Unordered Lists","text":""},{"location":"cheat_sheet/#syntax_3","title":"Syntax:","text":"<ul> <li><code>- Item 1</code> (bullet can be either <code>-</code>, <code>+</code> or <code>*</code>)</li> <li><code>+ Item 2</code></li> <li><code>....* Nested Item</code> (indent = space x4)</li> </ul>"},{"location":"cheat_sheet/#output_3","title":"Output:","text":"<ul> <li>Item 1</li> <li>Item 2<ul> <li>Nested Item</li> </ul> </li> </ul>"},{"location":"cheat_sheet/#ordered-lists","title":"Ordered Lists","text":""},{"location":"cheat_sheet/#syntax_4","title":"Syntax:","text":"<ul> <li><code>1. First Item</code></li> <li><code>2. Second Item</code></li> <li><code>....1. First nested Item</code> (indent = space x4) </li> <li><code>....2. Second nested Item</code></li> </ul>"},{"location":"cheat_sheet/#output_4","title":"Output:","text":"<ol> <li>First item</li> <li>Second item<ol> <li>First nested Item (auto-numbering corrected to <code>a, b, ...</code>)</li> <li>Second nested Item</li> </ol> </li> </ol>"},{"location":"cheat_sheet/#5-links","title":"5. Links","text":""},{"location":"cheat_sheet/#syntax_5","title":"Syntax:","text":"<ul> <li><code>[Displayed Text](Actual link)</code></li> <li><code>[Visit Google](https://www.google.com)</code> (link to a website)</li> <li><code>[Return to Index](index.md)</code> (link to another file)</li> <li><code>[Visit 'Line Break' section](cheat_sheet.md#2-line-break)</code> (link to a specific header in a file)</li> </ul>"},{"location":"cheat_sheet/#output_5","title":"Output:","text":"<ul> <li>Visit Google</li> <li>Return to Index</li> <li>Visit 'Line Break' section</li> </ul>"},{"location":"cheat_sheet/#6-images","title":"6. Images","text":""},{"location":"cheat_sheet/#syntax_6","title":"Syntax:","text":"<ul> <li><code>![Alt text](Image link)</code></li> <li><code>![dead link](http://unreacheable.com/nopic.png)</code></li> <li><code>![random local lemur](assets/lemur.jpg)</code></li> </ul>"},{"location":"cheat_sheet/#output_6","title":"Output:","text":""},{"location":"cheat_sheet/#7-code-blocks","title":"7. Code Blocks","text":""},{"location":"cheat_sheet/#syntax_7","title":"Syntax:","text":"<p>This is <code>`</code>inline code<code>`</code> in the middle of a sentence. (back tick : ctrl + alt + 7) <pre><code>```\nThis is  \n    multi-line  \n    code block\n```\n</code></pre> <pre><code>``` python title=\"Code block with syntax highlighting\"\nprint(\"Hello, World!\")\n```\n</code></pre></p> <p>Lexers list : ps1, Bash, md, python, etc... </p> <p>TODO : Add example of code block with line highlighting.</p>"},{"location":"cheat_sheet/#output_7","title":"Output:","text":"<p>This is <code>inline code</code> in the middle of a sentence.  </p> <pre><code>This is  \n    multi-line  \n    code block\n</code></pre> Code block with syntax highlighting<pre><code>print(\"Hello, World!\")\n</code></pre>"},{"location":"cheat_sheet/#8-tables","title":"8. Tables","text":""},{"location":"cheat_sheet/#syntax_8","title":"Syntax:","text":"<p>TODO : redo section + include tabs</p>"},{"location":"cheat_sheet/#output_8","title":"Output:","text":"Column 1 Column 2 Data 1 Data 2"},{"location":"cheat_sheet/#9-horizontal-line","title":"9. Horizontal Line","text":""},{"location":"cheat_sheet/#syntax_9","title":"Syntax:","text":"<p><code>---</code></p>"},{"location":"cheat_sheet/#output_9","title":"Output:","text":""},{"location":"cheat_sheet/#10-admonitions-collapsible-sections","title":"10. Admonitions &amp; Collapsible Sections","text":""},{"location":"cheat_sheet/#syntax_10","title":"Syntax:","text":"<p>List of admonition tags : note, abstract, info, tip, success, question, warning, failure, danger, bug, example and quote.  </p> Markdown<pre><code>!!! note \"\"\n    No title means no icon, color stays though.  \n    But don'ton't forget the quotes.\n</code></pre> Markdown<pre><code>??? warning \"No title gets an ugly result in collapsibles\"\n    Lorem ipsum dolor sit amet, consectetur adipiscing elit.\n</code></pre> HTML<pre><code>&lt;details&gt;\n  &lt;summary&gt;Click to expand&lt;/summary&gt;\n  Using HTML !\n&lt;/details&gt;\n</code></pre>"},{"location":"cheat_sheet/#output_10","title":"Output:","text":"<p>No title means no icon, color stays though. But don't forget the quotes.</p> No title gets an ugly result in collapsibles <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p> Click to expand   Using HTML !"},{"location":"cheat_sheet/#11-tooltips-annotations","title":"11. Tooltips &amp; Annotations","text":""},{"location":"cheat_sheet/#syntax_11","title":"Syntax:","text":"<p>Simple hover tooltip<pre><code>This tooltip example uses the *title attribute*{ title=  \n \"However it necessitates an extra css rule to get the underline and mouse cursor.\"  \n }.\n</code></pre> Single annotation<pre><code>Lorem ipsum dolor sit amet, (1) consectetur adipiscing elit.\n{ .annotate }\n\n1. I'm an annotation! I can contain `code`, __formatted\n    text__, images, ... basically anything that can be expressed in Markdown.\n</code></pre> Annotations in a list requiere the use of HTML and the attr_list extension<pre><code>&lt;div class=\"annotate\" markdown&gt;\n+ Etiam laoreet mattis quam eget vehicula. (1)\n+ In nunc sem, bibendum in ante a (2), ultrices iaculis dolor.\n&lt;/div&gt;\n\n1. I'm another annotation ! I can contain `code`, __formatted\n    text__, images, ... basically anything that can be expressed in Markdown.\n2.  I'm an annotation too !\n</code></pre></p> <p>Correct placement for annotations</p> <p>Material for Mkdocs will try and hide the annotations. Therefore they must always be placed in the last position in a bloc (end of section, end of page). Everything after will also be hidden.</p>"},{"location":"cheat_sheet/#output_11","title":"Output:","text":"<p>This tooltip example uses the title attribute.</p> <p>Lorem ipsum dolor sit amet, (1) consectetur adipiscing elit.</p> <ol> <li>I'm an annotation ! I can contain <code>code</code>, formatted     text, images, ... basically anything that can be expressed in Markdown.</li> </ol> <p>Annotations within a list : </p> <ul> <li>Etiam laoreet mattis quam eget vehicula. (1)</li> <li>In nunc sem, bibendum in ante a (2), ultrices iaculis dolor.</li> </ul> <ol> <li>I'm another annotation ! I can contain <code>code</code>, formatted     text, images, ... basically anything that can be expressed in Markdown.</li> <li>I'm an annotation too !</li> </ol>"},{"location":"cheat_sheet/#12-icons-emojis","title":"12. Icons &amp; Emojis","text":"<p>Coming soon &lt;-- this is an icon </p>"},{"location":"pattern-en/","title":"[Subject Title]","text":""},{"location":"pattern-en/#1-overview-introduction","title":"1. Overview / Introduction","text":"<ul> <li>What this page covers: Briefly explain the purpose of this page and what the reader will learn or achieve.</li> <li>Why this is important / What problem it solves: Provide context and motivation. Why did you implement this? What benefits does it offer (e.g., security, convenience, specific functionality)?</li> <li>Key concepts / Prerequisites: List any fundamental concepts the reader should understand before proceeding, or any prior steps that must be completed (e.g., \"Assumes you have a working Debian installation,\" \"Basic understanding of networking\").</li> </ul>"},{"location":"pattern-en/#2-planning-design-choices-optional-but-recommended","title":"2. Planning / Design Choices (Optional but Recommended)","text":"<ul> <li>Goals: What were your specific goals for this implementation?</li> <li>Alternative solutions considered (and why you chose this one): This is incredibly valuable for future reference. Why did you pick <code>mkdocs</code> over <code>sphinx</code>, or <code>SSH keys</code> over <code>password-only</code> authentication?</li> <li>System architecture / Network diagram (if applicable): A simple diagram (you can use Mermaid.js with Material for MkDocs!) can clarify complex setups.</li> </ul>"},{"location":"pattern-en/#3-implementation-steps","title":"3. Implementation Steps","text":"<p>This section should be a clear, step-by-step tutorial. Each step should have a goal and the commands to achieve it.</p>"},{"location":"pattern-en/#31-sub-topic-1-eg-installing-necessary-packages","title":"3.1. [Sub-topic 1: e.g., Installing Necessary Packages]","text":"<ul> <li>Objective: What are you trying to accomplish in this sub-step?</li> <li>Explanation: Briefly explain why these packages are needed or what this command does.</li> <li>Commands: Use code blocks with language highlighting. If a command requires root privileges, indicate it.     <pre><code>sudo apt update\nsudo apt install &lt;package-name&gt; # Explain why this package is needed\n</code></pre></li> <li>Expected Output (Optional but helpful): Show a truncated or key part of the command's output so the reader knows what to expect.     <pre><code>Output example...\n</code></pre></li> <li>Notes / Troubleshooting: Any specific considerations, common issues, or tips for this step.</li> </ul>"},{"location":"pattern-en/#32-sub-topic-2-eg-configuration","title":"3.2. [Sub-topic 2: e.g., Configuration]","text":"<ul> <li>Objective: What configuration are you setting up?</li> <li>Explanation: Detail the purpose of configuration files, specific parameters, and their impact.</li> <li>Commands (for editing files): <pre><code>sudo nano /etc/config/file.conf\n</code></pre></li> <li>File Content (using a code block for the file itself): <pre><code># Example configuration file\n[Section]\nParameter1 = value1\n# This line is important\nParameter2 = value2 # This value does X\nAnotherParameter = 0\n# Enable this for Y\nYetAnother = true\n</code></pre> Use <code>linenums</code> and <code>hl_lines</code> as you mentioned for excellent clarity.</li> <li>Validation Commands (e.g., <code>systemctl status</code>): <pre><code>systemctl status service-name\n</code></pre></li> <li>Expected Output: <pre><code>\u25cf service-name.service - Description\n     Loaded: loaded (/lib/systemd/system/service-name.service; enabled; vendor preset: enabled)\n     Active: active (running) since ...\n</code></pre></li> <li>Notes / Troubleshooting: Any specific considerations, common issues, or tips for this step.</li> </ul>"},{"location":"pattern-en/#4-verification-testing","title":"4. Verification / Testing","text":"<ul> <li>How to confirm everything is working: Provide commands or steps to test the successful implementation.     <pre><code>ssh user@your-server-ip # To test SSH connection\n</code></pre></li> <li>Expected outcome: What should the user see or experience if the implementation is successful?</li> </ul>"},{"location":"pattern-en/#5-usage-daily-operations-if-applicable","title":"5. Usage / Daily Operations (if applicable)","text":"<ul> <li>Common commands: List commands for daily use (e.g., \"How to check SSH logs,\" \"How to add a new SSH key\").     <pre><code>journalctl -u sshd.service\n</code></pre></li> <li>Tips and tricks: Any useful shortcuts or best practices.</li> </ul>"},{"location":"pattern-en/#6-maintenance-future-considerations","title":"6. Maintenance / Future Considerations","text":"<ul> <li>Backup strategies: How to back up relevant configurations or data.</li> <li>Updating the package/service: How to keep it updated.</li> <li>Potential issues and solutions: Foresee any common problems that might arise in the future and how to address them.</li> <li>Scalability / Future enhancements: Ideas for extending or improving the setup later.</li> </ul>"},{"location":"pattern-en/#7-resources-further-reading","title":"7. Resources / Further Reading","text":"<ul> <li>Official documentation: Link to man pages, official project documentation, etc.</li> <li>Useful articles/tutorials: Any external sources that helped you.</li> <li>Related documentation pages: Link to other pages within your personal documentation that are relevant.</li> </ul>"},{"location":"pattern-en/#8-changelog-optional-but-good-for-personal-docs","title":"8. Changelog (Optional but good for personal docs)","text":"<ul> <li>Date: Changes made.<ul> <li>2023-10-27: Initial setup.</li> <li>2024-01-15: Added fail2ban integration.</li> </ul> </li> </ul>"},{"location":"pattern-fr/","title":"[Titre du sujet]","text":""},{"location":"pattern-fr/#1-vue-densemble-introduction","title":"1. Vue d'ensemble / Introduction","text":"<ul> <li>Ce que cette page couvre : Expliquez bri\u00e8vement l\u2019objectif de cette page et ce que le lecteur va apprendre ou r\u00e9aliser.</li> <li>Pourquoi c\u2019est important / Quel probl\u00e8me cela r\u00e9sout : Donnez du contexte et de la motivation. Pourquoi avez-vous mis cela en place ? Quels avantages cela apporte-t-il (s\u00e9curit\u00e9, praticit\u00e9, fonctionnalit\u00e9s sp\u00e9cifiques\u2026) ?</li> <li>Notions cl\u00e9s / Pr\u00e9requis : Listez les notions de base que le lecteur doit comprendre avant de continuer, ou les \u00e9tapes pr\u00e9alables n\u00e9cessaires (ex. : \u00ab Part du principe que Debian est install\u00e9 \u00bb, \u00ab Notions de base en r\u00e9seau \u00bb).</li> </ul>"},{"location":"pattern-fr/#2-planification-choix-darchitecture-optionnel-mais-recommande","title":"2. Planification / Choix d\u2019architecture (Optionnel mais recommand\u00e9)","text":"<ul> <li>Objectifs : Quels \u00e9taient vos objectifs pr\u00e9cis pour cette mise en \u0153uvre ?</li> <li>Solutions alternatives envisag\u00e9es (et pourquoi ce choix) : Tr\u00e8s utile pour r\u00e9f\u00e9rence future. Pourquoi avoir choisi <code>mkdocs</code> plut\u00f4t que <code>sphinx</code>, ou l\u2019authentification par cl\u00e9 SSH plut\u00f4t que par mot de passe ?</li> <li>Architecture syst\u00e8me / Sch\u00e9ma r\u00e9seau (si applicable) : Un simple diagramme (utilisable via Mermaid.js dans Material for MkDocs) peut clarifier les configurations complexes.</li> </ul>"},{"location":"pattern-fr/#3-etapes-de-mise-en-uvre","title":"3. \u00c9tapes de mise en \u0153uvre","text":"<p>Cette section doit \u00eatre un tutoriel clair et progressif. Chaque \u00e9tape contient un objectif et les commandes n\u00e9cessaires.</p>"},{"location":"pattern-fr/#31-sous-sujet-1-par-ex-installation-des-paquets-necessaires","title":"3.1. [Sous-sujet 1 : par ex., Installation des paquets n\u00e9cessaires]","text":"<ul> <li>Objectif : Que cherchez-vous \u00e0 accomplir \u00e0 cette \u00e9tape ?</li> <li>Explication : Pourquoi ces paquets sont-ils n\u00e9cessaires ? Que font ces commandes ?</li> <li>Commandes : Utilisez des blocs de code avec coloration syntaxique. Pr\u00e9cisez si des droits root sont requis.     <pre><code>sudo apt update\nsudo apt install &lt;nom-du-paquet&gt; # Pourquoi ce paquet est requis\n</code></pre></li> <li>Sortie attendue (optionnel mais utile) : Affichez un extrait ou un exemple de la sortie attendue pour guider le lecteur.     <pre><code>Exemple de sortie...\n</code></pre></li> <li>Remarques / D\u00e9pannage : Consid\u00e9rations sp\u00e9cifiques, probl\u00e8mes fr\u00e9quents, ou astuces utiles.</li> </ul>"},{"location":"pattern-fr/#32-sous-sujet-2-par-ex-configuration","title":"3.2. [Sous-sujet 2 : par ex., Configuration]","text":"<ul> <li>Objectif : Quelle configuration mettez-vous en place ?</li> <li>Explication : Pr\u00e9cisez le r\u00f4le des fichiers de configuration, les param\u00e8tres sp\u00e9cifiques et leurs effets.</li> <li>Commandes (\u00e9dition de fichiers) : <pre><code>sudo nano /etc/config/fichier.conf\n</code></pre></li> <li>Contenu du fichier (utiliser un bloc code avec <code>linenums</code> et <code>hl_lines</code>) : <pre><code># Exemple de fichier de configuration\n[Section]\nParametre1 = valeur1\n# Cette ligne est importante\nParametre2 = valeur2 # Cette valeur permet de faire X\nAutreParam = 0\n# Activer ceci pour Y\nEncoreUn = true\n</code></pre></li> <li>Commandes de validation (ex. : <code>systemctl status</code>) : <pre><code>systemctl status nom-du-service\n</code></pre></li> <li>Sortie attendue : <pre><code>\u25cf nom-du-service.service - Description\n     Charg\u00e9 : charg\u00e9 (/lib/systemd/system/nom-du-service.service; activ\u00e9; preset : activ\u00e9)\n     Actif : actif (en fonctionnement) depuis ...\n</code></pre></li> <li>Remarques / D\u00e9pannage : Comme ci-dessus, partagez vos r\u00e9flexions ou pi\u00e8ges courants.</li> </ul>"},{"location":"pattern-fr/#4-verification-tests","title":"4. V\u00e9rification / Tests","text":"<ul> <li>Comment v\u00e9rifier que tout fonctionne : Commandes ou \u00e9tapes de test.     <pre><code>ssh utilisateur@ip-du-serveur # Pour tester la connexion SSH\n</code></pre></li> <li>R\u00e9sultat attendu : Que devrait-on voir ou constater si tout fonctionne correctement ?</li> </ul>"},{"location":"pattern-fr/#5-utilisation-quotidienne-si-applicable","title":"5. Utilisation quotidienne (si applicable)","text":"<ul> <li>Commandes courantes : Pour les op\u00e9rations quotidiennes (ex. : consulter les logs SSH, ajouter une cl\u00e9).     <pre><code>journalctl -u sshd.service\n</code></pre></li> <li>Astuces : Bonnes pratiques, raccourcis utiles, etc.</li> </ul>"},{"location":"pattern-fr/#6-maintenance-evolutions-futures","title":"6. Maintenance / \u00c9volutions futures","text":"<ul> <li>Sauvegardes : Comment sauvegarder les fichiers ou configurations importants.</li> <li>Mises \u00e0 jour du service / paquet : Comment assurer le suivi et la mise \u00e0 jour.</li> <li>Probl\u00e8mes potentiels : Probl\u00e8mes pr\u00e9visibles et solutions associ\u00e9es.</li> <li>\u00c9volutivit\u00e9 / Am\u00e9liorations futures : Pistes d\u2019\u00e9volution, d\u2019optimisation ou d\u2019extension.</li> </ul>"},{"location":"pattern-fr/#7-ressources-liens-utiles","title":"7. Ressources / Liens utiles","text":"<ul> <li>Documentation officielle : Man pages, docs officielles du projet, etc.</li> <li>Articles / tutoriels pertinents : Sources externes ayant aid\u00e9.</li> <li>Pages li\u00e9es : Liens vers d\u2019autres pages de votre propre documentation.</li> </ul>"},{"location":"pattern-fr/#8-journal-des-modifications-optionnel-mais-pratique","title":"8. Journal des modifications (Optionnel mais pratique)","text":"<ul> <li>Date : Modifications apport\u00e9es.<ul> <li>2023-10-27 : Mise en place initiale.</li> <li>2024-01-15 : Ajout de l'int\u00e9gration avec fail2ban.</li> </ul> </li> </ul>"},{"location":"test/","title":"Annotation Test","text":"<ul> <li>Lorem ipsum dolor sit amet, (1) consectetur adipiscing elit.</li> <li>Lorem ipsum dolor sit amet, (2) consectetur adipiscing elit.</li> </ul> <ol> <li>I'm an annotation!</li> <li>I'm an annotation too! I can contain <code>code</code>, formatted     text, images, ... basically anything that can be expressed in Markdown.</li> </ol>"},{"location":"test/#testage","title":"testage","text":"<p>Lorem ipsum dolor sit amet, (1) consectetur adipiscing elit.</p> <p>Je suis une ligne suppl\u00e9mentaire</p> <ol> <li>I'm an annotation! I can contain <code>code</code>, formatted     text, images, ... basically anything that can be expressed in Markdown.</li> </ol>"},{"location":"test/#section-suivante","title":"section suivante","text":"<p>blabla...</p>"},{"location":"homeserver/","title":"Mon Home Server","text":""},{"location":"homeserver/#1-introduction","title":"1. Introduction","text":"<ul> <li> <p>Le but de cette suite de documents est de maintenir des tutoriels \u00e0 jour afin de pouvoir refaire \u00e0 l'identique / am\u00e9liorer le server priv\u00e9, sans avoir &amp; red\u00e9couvrir la roue \u00e0 chaque fois.</p> </li> <li> <p>Pr\u00e9requis : </p> <ul> <li>Le hardware devrait int\u00e9grer un CPU Intel de pr\u00e9f\u00e9rence, avec QuickSync, pour b\u00e9n\u00e9ficier de l'acc\u00e9l\u00e9ration mat\u00e9rielle lors du transcodage Video.</li> <li>On doit disposer d'un nom de domaine. Ici on utilisera vps-de-carter.org, manag\u00e9 via cloudflare.</li> <li>La box / routeur doit pouvoir attribuer une IP fixe sur le r\u00e9seau local (bail statique hors de la plage de DHCP), ici on utilise 192.168.1.69. Le routeur permet en l'occurence de fixer un nom d'hote pour la machine sur le r\u00e9seau local, ici : ps-de-carter. </li> </ul> </li> </ul>"},{"location":"homeserver/#2-planification-choix-darchitecture","title":"2. Planification / Choix d\u2019architecture","text":"<ul> <li>Objectifs :  Le but premier est d'avoir un serveur priv\u00e9 pour stocker une biblioth\u00e8que de m\u00e9dia (Audio et Video). </li> <li>Solutions alternatives envisag\u00e9es (et pourquoi ce choix) : Tr\u00e8s utile pour r\u00e9f\u00e9rence future. Pourquoi avoir choisi <code>mkdocs</code> plut\u00f4t que <code>sphinx</code>, ou l\u2019authentification par cl\u00e9 SSH plut\u00f4t que par mot de passe ?</li> <li>Architecture syst\u00e8me / Sch\u00e9ma r\u00e9seau (si applicable) : Un simple diagramme (utilisable via Mermaid.js dans Material for MkDocs) peut clarifier les configurations complexes.</li> </ul>"},{"location":"homeserver/#3-etapes-de-mise-en-uvre","title":"3. \u00c9tapes de mise en \u0153uvre","text":"<p>Cette section doit \u00eatre un tutoriel clair et progressif. Chaque \u00e9tape contient un objectif et les commandes n\u00e9cessaires.</p>"},{"location":"homeserver/#31-sous-sujet-1-par-ex-installation-des-paquets-necessaires","title":"3.1. [Sous-sujet 1 : par ex., Installation des paquets n\u00e9cessaires]","text":"<ul> <li>Objectif : Que cherchez-vous \u00e0 accomplir \u00e0 cette \u00e9tape ?</li> <li>Explication : Pourquoi ces paquets sont-ils n\u00e9cessaires ? Que font ces commandes ?</li> <li>Commandes : Utilisez des blocs de code avec coloration syntaxique. Pr\u00e9cisez si des droits root sont requis.     <pre><code>sudo apt update\nsudo apt install &lt;nom-du-paquet&gt; # Pourquoi ce paquet est requis\n</code></pre></li> <li>Sortie attendue (optionnel mais utile) : Affichez un extrait ou un exemple de la sortie attendue pour guider le lecteur.     <pre><code>Exemple de sortie...\n</code></pre></li> <li>Remarques / D\u00e9pannage : Consid\u00e9rations sp\u00e9cifiques, probl\u00e8mes fr\u00e9quents, ou astuces utiles.</li> </ul>"},{"location":"homeserver/#32-sous-sujet-2-par-ex-configuration","title":"3.2. [Sous-sujet 2 : par ex., Configuration]","text":"<ul> <li>Objectif : Quelle configuration mettez-vous en place ?</li> <li>Explication : Pr\u00e9cisez le r\u00f4le des fichiers de configuration, les param\u00e8tres sp\u00e9cifiques et leurs effets.</li> <li>Commandes (\u00e9dition de fichiers) : <pre><code>sudo nano /etc/config/fichier.conf\n</code></pre></li> <li>Contenu du fichier (utiliser un bloc code avec <code>linenums</code> et <code>hl_lines</code>) : <pre><code># Exemple de fichier de configuration\n[Section]\nParametre1 = valeur1\n# Cette ligne est importante\nParametre2 = valeur2 # Cette valeur permet de faire X\nAutreParam = 0\n# Activer ceci pour Y\nEncoreUn = true\n</code></pre></li> <li>Commandes de validation (ex. : <code>systemctl status</code>) : <pre><code>systemctl status nom-du-service\n</code></pre></li> <li>Sortie attendue : <pre><code>\u25cf nom-du-service.service - Description\n     Charg\u00e9 : charg\u00e9 (/lib/systemd/system/nom-du-service.service; activ\u00e9; preset : activ\u00e9)\n     Actif : actif (en fonctionnement) depuis ...\n</code></pre></li> <li>Remarques / D\u00e9pannage : Comme ci-dessus, partagez vos r\u00e9flexions ou pi\u00e8ges courants.</li> </ul>"},{"location":"homeserver/#4-verification-tests","title":"4. V\u00e9rification / Tests","text":"<ul> <li>Comment v\u00e9rifier que tout fonctionne : Commandes ou \u00e9tapes de test.     <pre><code>ssh utilisateur@ip-du-serveur # Pour tester la connexion SSH\n</code></pre></li> <li>R\u00e9sultat attendu : Que devrait-on voir ou constater si tout fonctionne correctement ?</li> </ul>"},{"location":"homeserver/#5-utilisation-quotidienne-si-applicable","title":"5. Utilisation quotidienne (si applicable)","text":"<ul> <li>Commandes courantes : <pre><code>journalctl -u sshd.service\n</code></pre></li> <li>Astuces : Bonnes pratiques, raccourcis utiles, etc.</li> </ul>"},{"location":"homeserver/#6-maintenance-evolutions-futures","title":"6. Maintenance / \u00c9volutions futures","text":"<ul> <li>Mises \u00e0 jour : </li> <li>Probl\u00e8mes potentiels : </li> <li>\u00c9volutivit\u00e9 / Am\u00e9liorations futures : <ul> <li>NextCloud</li> <li>SmartMonTools</li> <li>Monitoring / Pilotage</li> <li>Foundry</li> <li>Satisfactory</li> <li>PiHole</li> </ul> </li> </ul>"},{"location":"homeserver/#7-ressources-liens-utiles","title":"7. Ressources / Liens utiles","text":"<ul> <li>Articles / tutoriels pertinents : </li> </ul>"},{"location":"homeserver/#8-journal-des-modifications","title":"8. Journal des modifications","text":"<ul> <li>Date : Modifications apport\u00e9es.<ul> <li>20-06-2025 : Mise en place nouveau patron.</li> </ul> </li> </ul> <p>## 1. Linux Install</p> <p>## 2. SSH</p> <p>## 3. Hardening Part 1</p> <p>## 4. Mounts</p> <p>## 5. Samba</p>"},{"location":"homeserver/#final-touches","title":"Final Touches","text":"<p>avant le montage des disques etc... </p> <p>On a fait l'install en Fr (pas d'autre moyen pour pouvoir choisir France comme localisation). Du coup on rajoute l'anglais dans les locales.</p> <p>Dans le wizard suivant on cherche <code>en_US.UTF8</code> Bash<pre><code>sudo dpkg-reconfigure locales\n</code></pre> On peut v\u00e9rifier que les locales sont bonnes avec <code>locale -a</code> Il faut red\u00e9marrer pour prendre en compte la nouvelle langue par d\u00e9fault.</p>"},{"location":"homeserver/#virer-un-package","title":"virer un package :","text":"<p>sudo apt purge postfix sudo apt autoremove --dryrun pour tester s'il y ad 'autres d\u00e9pendances \u00e0 virer</p> <p>TODO en vrac :  script + cloudflare API pour mainteanir les A records \u00e0 jour (pas d'ip fixe chez orange). ou bien ddclient. https://developers.cloudflare.com/dns/manage-dns-records/how-to/managing-dynamic-ip-addresses/  </p>"},{"location":"homeserver/debian_install/","title":"Debian install","text":""},{"location":"homeserver/debian_install/#1-linux-install","title":"1. Linux Install","text":"<p>Debian, install\u00e9 en headless, sans root user  </p> <ul> <li> <p>Choix d'install normale (sans graphics)</p> </li> <li> <p>Durant l'install de Debian, on d\u00e9coche les options de GUI gnome etc.. et on coche SSH Server. (moins de package = moins d'overhead = moins de surface)</p> </li> <li> <p>On ne rentre pas de mot de passe pour root =&gt; l'utilisateur root est d\u00e9asctiv\u00e9. </p> </li> <li> <p>on fini avec l'install de GRUB</p> </li> </ul> <p>on peut v\u00e9rifier que root est d\u00e9sactiv\u00e9 avec : <code>$ sudo grep root /etc/shadow  cut -d':' -f2</code> (TODO : rajouter explication de la commande)</p> <p>Next : SSH</p>"},{"location":"homeserver/docker/","title":"Docker","text":""},{"location":"homeserver/docker/#docker-and-docker-compose","title":"docker and docker compose","text":"<p>install pour debian install using the apt repo (3 \u00e9tapes)</p> <p>il faut s'ajouter au groupe docker sudo usermod -aG docker $USER</p>"},{"location":"homeserver/docker/#docker-network","title":"docker network","text":"<p>docker network create docker_network</p>"},{"location":"homeserver/docker/#foundryvtt-089","title":"foundryvtt 0.8.9","text":"<p>sudo adduser --system --no-create-home --group foundry_user sudo usermod -aG vault_dwellers foundry_user</p>"},{"location":"homeserver/docker/#jellyfin","title":"jellyfin","text":"<p>sudo adduser --system --no-create-home --group jellyfin_user sudo usermod -aG vault_dwellers jellyfin_user</p>"},{"location":"homeserver/foundry/","title":"Foundry VTT","text":"<p>https://foundryvtt.wiki/en/setup/hosting/Docker</p>"},{"location":"homeserver/foundry/#download","title":"Download","text":"<p>Dans la section Purchased Licences du compte sur Foundry (ex: https://foundryvtt.com/community/carterdc/licenses) Choisir node.js en OS et la version stable souhait\u00e9e, ici 0.8.9 (build 102)</p> <p>Copier l'URL temporaire vers ce build (bouton TIMED URL) et ex\u00e9cuter la commande suivante pour download l'archive dans le dossier docker/foundry</p> <p>sudo wget -O foundry.zip \"https://r2.foundryvtt.com/releases/8.102/FoundryVTT-8 .102.zip?verify=1750662221-RLzFoMdIXFG5nExo0rT1Aitc4Bbj1t5ciXWM9tOMYRg%3D\"</p> <p>Ensuite d\u00e9compresser l'archive dans ./pkg avec unzip (<code>sudo apt install unzip</code> si besoin) : sudo unzip foundry.zip -d ./pkg</p> <p>update la conf nginx pour foundry pour rajouter le support des websockets : proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \"upgrade\";</p>"},{"location":"homeserver/hardening_1/","title":"Hardening 1","text":""},{"location":"homeserver/hardening_1/#uncomplicated-firewall","title":"Uncomplicated FireWall","text":"<p>Ufw est un front-end de iptables. Par d\u00e9fault on vire tout ce qui entre. Pour ne pas se tirer une balle dans le pied, on ajoute des acc\u00e8s au service ssh sur le port qu'on a d\u00e9fini plus t\u00f4t.</p> <p>Bash<pre><code>sudo ufw default deny incoming\nsudo ufw default allow outgoing\nsudo ufw allow from 192.168.1.0/24 to any port 2357 proto tcp\nsudo ufw allow from 10.8.0.0/24 to any port 2357 proto tcp  # WireGuard subnet\n</code></pre> On anticipe la suite o\u00f9 on voudra acc\u00e9der aussi via un tunnel wireguard (avec un masque de sous-r\u00e9seau en 10.8.0.0/24)</p> <p>On lance le firewall. Cette commande active aussi ufw comme le ferait un <code>systemctl enable</code> Bash<pre><code>sudo ufw enable\n</code></pre></p> <p>A tout moment on peut revoir les r\u00e8gles ajout\u00e9es : Bash<pre><code>sudo ufw status verbose # pour voir aussi les policies\nsudo ufw status numbered # les numero des r\u00e8gles facilitent leur suppression\n</code></pre></p>"},{"location":"homeserver/hardening_1/#fail2ban","title":"Fail2Ban","text":"<p>sudo apt install fail2ban //on copie la conf par d\u00e9faut pour \u00e9viter de se faire \u00e9craser par une update. (recommandation dans le fichier) sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local</p>"},{"location":"homeserver/hardening_1/#monitoring","title":"Monitoring","text":""},{"location":"homeserver/monitoring/","title":"Monitoring","text":""},{"location":"homeserver/monitoring/#install-de-cockpit","title":"install de cockpit","text":"<p>netdata ?  les services de cockpit ne sont pas d\u00e9marr\u00e9s par d\u00e9faut et s'arretent tous seul.  Le seul service qui tourne et doit \u00eatre enble/disable est cockpit.socket  </p>"},{"location":"homeserver/monitoring/#ouverrture-ports-ufw","title":"Ouverrture ports ufw","text":"<p>sudo ufw allow from 192.168.1.0/24 to any port 9090 proto tcp sudo ufw allow from 10.8.0.0/24 to any port 9090 proto tcp</p>"},{"location":"homeserver/monitoring/#msmtp","title":"msmtp","text":"<p>sudo apt install msmtp msmtp-mta mailutils</p> <p>https://myaccount.google.com/apppasswords yige gvmt vsyj eleu </p> <p>Attention, AppArmor empeche par d\u00e9fault msmtp de cr\u00e9er / enregistrer ses logs </p>"},{"location":"homeserver/monitoring/#smart","title":"SMART","text":"<p>sudo apt install smartmontools smart-notifier</p> <p>sudo update-smart-drivedb \u00e0 relancer qd il ya un nv drive.</p> <p>v\u00e9rif pour chaque drive s'il est compatible smart et smart est activ\u00e9 (+ plein d'autres infos) sudo smartctl -i /dev/sda sudo smartctl -a -d nvme /dev/nvme0n1 un peu diff pour les disques nvme</p> <p>test rapide sudo smartctl -t short /dev/sda une minute d'attente avant de check avec sudo smartctl -l selftest /dev/sda  </p>"},{"location":"homeserver/mounts/","title":"Mounts","text":"<p>On va utiliser mergerfs pour cr\u00e9er un point de montage virtuel et ainsi compiler tous les disques en un seul.</p>"},{"location":"homeserver/mounts/#formatage","title":"Formatage","text":"<p>Les disques de donn\u00e9es sont format\u00e9s en entier en ext4 (pas de partionnage n\u00e9cessaire pour ce qu'on fait).</p> <p><code>lsblk -f</code> # pour voir les file systems et uuid <code>sudo mkfs.ext4 /dev/sda</code> # cr\u00e9ation du file system, directement</p>"},{"location":"homeserver/mounts/#montage","title":"Montage","text":"<p>sudo apt install mergerfs</p>"},{"location":"homeserver/mounts/#crea-des-repertoires","title":"Cr\u00e9a des r\u00e9pertoires","text":"<p>sudo mkdir drive1 sudo mkdir drive2 sudo mkdir drive3 sudo mkdir vault sudo mkdir parity</p> <p><code>lsblk -f</code> # pour voir les device, file systems et uuid</p> <p>Montage \u00e0 la main :  sudo mount /dev/sda /mnt/disk1</p> <p>Montage permanent :  sudo nano /etc/fstab  Rajouter  UUID=359d90df-f17a-42f6-ab13-df13bf356de7 /mnt/disk1 ext4 defaults 0 2</p> <p>Fusion des disks dans un seul dossier. Option \u00e0 choisir, ici epmfs (existing path, most free space)</p> <p>/mnt/disk1:/mnt/disk2:/mnt/disk3 /mnt/vault fuse.mergerfs defaults,allow_other,use_ino,cache.files=off,moveonenospc=true,category.create=epmfs,minfreespace=10G,default_permissions,umask=002 0 0</p>"},{"location":"homeserver/mounts/#permissions","title":"Permissions","text":"<p>Cr\u00e9a d'un user system (pas de login, pas de home) sudo useradd -r -M -s /usr/sbin/nologin samba_user ou bien sp\u00e9cific debian :</p> <p>sudo adduser --system --no-create-home --group samba_user</p> <p>Cr\u00e9a d'un groupe avec tous les droits sur le vault: sudo addgroup vault_dwellers sudo usermod -aG vault_dwellers samba_user</p> <p>(pas oublier de se rajouter soi-m^me dans le groupe : <code>sudo usermod -aG vault_dwellers $(whoami)</code>)</p> <p>ajouter vault_dwellers en proprio sur le vault (et les disques) sudo chown -R root:media /mnt/drive1</p> <p>sudo find /mnt/vault -type d -exec chmod 2775 {} \\; sudo find /mnt/vault -type f -exec chmod 664 {} \\; \u00e0 faire sur chaque drive</p> <p>Permissions ACL : installation de ACL : sudo apt install acl -y</p> <p>For Samba service (full access) : sudo setfacl -R -m u:sambauser:rwx /mnt/vault sudo setfacl -R -d -m u:sambauser:rwx /mnt/vault</p>"},{"location":"homeserver/mounts/#parite","title":"Parit\u00e9","text":"<p>Le disque de parit\u00e9 \u00e9tant neuf et non format\u00e9 on doit d'abord cr\u00e9er une partition. on va cr\u00e9er une partition sur la totalit\u00e9 du disque, puis formater en XFS. ext4 est limit\u00e9 \u00e0 16T par fichier mais XFS est plus adapt\u00e9 \u00e0 la gestion des gros fichiers.</p>"},{"location":"homeserver/mounts/#methode-interactive","title":"M\u00e9thode interactive","text":"<p>sudo fdisk /dev/sdd puis g-&gt;n-&gt;1-&gt;enter-&gt;enter-&gt;w</p>"},{"location":"homeserver/mounts/#methode-directe","title":"M\u00e9thode directe","text":"<p>sudo fdisk /dev/sdd &lt;&lt;EOF g    # create a new empty GPT partition table n    # add a new partition [Enter]  # partition number: accept default \u201c1\u201d [Enter]  # first sector: accept default (start of disk) [Enter]  # last sector: accept default (end of disk) w    # write table and exit EOF</p>"},{"location":"homeserver/mounts/#formatage-en-xfs","title":"Formatage en XFS :","text":"<p>sudo apt install xfsprogs</p> <p>mkfs.xfs -f -L parity /dev/sdd1</p>"},{"location":"homeserver/mounts/#install-et-config-de-snapraid","title":"install et config de snapraid","text":""},{"location":"homeserver/mounts/#note-creation-dun-sym-link","title":"note : cr\u00e9ation d'un sym link :","text":"<p>sudo ln -s /mnt/vault/my_audio/music ./music_library  sudo rm music_library pour l'enlever sans risque pour l'original</p>"},{"location":"homeserver/pi-hole/","title":"Pi hole","text":"<p>installation de pi-hole nativement (pas dans un container). On pourrait utiliser un container avec le network en mode host. Sinon, le bridge interne de docker risque de masquer des infos pertinentes sur les clients. </p> <p>l'install en elle meme consiste en l'execution d'un script depuis le site de pi-hole.net.</p> <p>On peut le DL et l'ex\u00e9cuter dans la foul\u00e9e avec un pipe vers bash curl -sSL https://install.pi-hole.net | bash</p> <p>durant l'install, on confirme que le server a bien une ip fixe, on choisi l'inteface sur laquelle pi-hole doit communiquer eth0, enop0s3 ou eno1 suivant les sys\u00e8mes. bcp d'autres interfaces apparaissent si dockeer est d\u00e9j\u00e0 configur\u00e9, notament le bridge (br) et des interfaces vituelles (veth).  </p> <p>On choisi \u00e0 la fin le service DNS qui r\u00e9soud les requetes une fois qu'elles ont \u00e9t\u00e9 filtr\u00e9es. Cloudflare est une bonne option mais on peut vouloir garder les DNS orange pour plus de facilit\u00e9 avec le boitier TV.  </p> <p>A la fin de l'installation on peut noter le mdp, mais on va le changer de toute fa\u00e7on avec sudo pihole setpassword (pas besoind e l'ancien mdp)  </p> <p>On r\u00e8gle ensuite le conflit de ports avec notre proxy d\u00e9j\u00e0 en \u00e9coute sur les ports 80 et 443. sudo nano /etc/pihole/pihole.toml // on cherche la ligne port = \"80o,443os,[::]:80o,[::]:443os\" // on remplace par  port = \"8080o,8443os,[::]:8080o,[::]:8443os\"</p> <p>et on red\u00e9marre pi-hole avec la nouvelle config  sudo systemctl restart pihole-FTL</p>"},{"location":"homeserver/pi-hole/#firewall","title":"Firewall","text":"<p>il faut de toute \u00e9vidence ouvrir le port 53 pour les requetes DNS : sudo ufw allow 53/tcp comment 'Allow DNS (TCP) for query resolution' sudo ufw allow 53/udp comment 'Allow DNS (UDP) for query resolution'</p> <p>Comme avec la livebox on doit aussi remplacer le DHCP (sinon on ne peut pas imposer notre dns) : sudo ufw allow 67/udp comment 'Allow DHCP (UDP) for client IP assignment'</p> <p>enfin on authorise l'access local aux nouveaux ports de l'interface web de pihole : sudo ufw allow from 192.168.1.0/24 to any port 8080 proto tcp comment 'Allow Pi-hole Admin Web UI from LAN' sudo ufw allow from 192.168.1.0/24 to any port 8443 proto tcp comment 'Allow Pi-hole Admin Web UI from LAN'</p>"},{"location":"homeserver/pi-hole/#config-interface-server","title":"config interface server","text":"<p>pour que pi-hole puisse filter les queries sortant du server et surtout les logger (indispensable pour un bon monitoring)</p> <p>Bash<pre><code>sudo nano /etc/network/interfaces\n</code></pre> interfaces<pre><code># modifier dns-nameservers vers localhost et la gateway en secondary (optionnel)\niface enp0s31f6 inet static\n    address 192.168.1.69\n    netmask 255.255.255.0\n    gateway 192.168.1.1\n    dns-nameservers 127.0.0.1 192.168.1.1\n</code></pre>  sudo systemctl restart networking</p>"},{"location":"homeserver/pi-hole/#config-livebox","title":"Config Livebox","text":"<p>suffit de d\u00e9cocher le service DHCP virer ipv6 peut aider il parait  </p>"},{"location":"homeserver/pi-hole/#tuto-pour-le-boitier-tv","title":"tuto pour le boitier TV","text":"<p>https://forums.framboise314.fr/viewtopic.php?t=5960 https://www.journaldufreenaute.fr/configurer-pi-hole-utiliser-dns-dorange/</p>"},{"location":"homeserver/pi-hole/#config-pihole","title":"config pihole","text":"<p>Local DNS :  ps-de-carter.home (pour continuer de se co en ssh avec carter@ps-de-carter) ajouter la r\u00e9solution des services locaux (navidrome, jellyfin, foudry etc.. )</p>"},{"location":"homeserver/pi-hole/#dns-hairpinning-avoidance","title":"DNS Hairpinning Avoidance","text":"<p>On va \u00e9viter que les requetes qu'on fait vers jellyfin.vps-de-carter.org partent se faire r\u00e9soudre \u00e0 l'ext\u00e9rieur pour revenir ensuite au m^me r\u00e9seau local. </p>"},{"location":"homeserver/re-partition/","title":"Re partition","text":"<p>La restoration du system avec rsnapshot peut profiter d'une partition d\u00e9di\u00e9e. On table g\u00e9n\u00e9ralement sur 10 \u00e0 30% du volume system.</p> <p>On va en profiter pour augmenter aussi la partition de swap de 1Go \u00e0 8Go (vraiment pas besoin d'autant avec 32Go de ram et sans hibernation).</p>"},{"location":"homeserver/re-partition/#desactivation-de-la-partition-actuelle-de-swap","title":"D\u00e9sactivation de la partition actuelle de swap","text":"<p>Pour \u00e9viter des ennuis de red\u00e9marrage apr\u00e8s avoir supprim\u00e9 et recr\u00e9\u00e9 la partition de swap, on va dans fstab pour la commenter.</p> <p>Au pire, une fois dans GParted on aura acc\u00e8s \u00e0 un terminal pour monter la partition de boot et aller \u00e9diter fstab si besoin.</p>"},{"location":"homeserver/re-partition/#gparted-live","title":"GParted Live","text":"<p>On ne peut pas utiliser l'OS install\u00e9 pour repattionner son propre disque de boot. Donc on va utiliser un autre OS sur un clef USB.  On burn un iso de GParted Live sur une clusb avec balena etcher ou autre.</p> <p>GNOME Partition Editor</p> <p>Sur 1To, on va r\u00e9duire la partiton de boot \u00e0 700Go (716 800Mo), bouger et resize la parttion de swap \u00e0 8Go (8 192Mo), dans le reste de la partition \u00e9tendue, on cr\u00e9e une partition ext4 pour rsnapshot. Il doit rester env 223Go soit env 30%  de la partition de boot. (Tr\u00e8s suffisant pour timeshift) </p>"},{"location":"homeserver/re-partition/#system-restore","title":"System Restore","text":"<p>On va utiliser Rsnapshot pour cr\u00e9er des points de restoration.</p> <p>/!\\ On pourrait vouloir exclure explicitement les symlink, meme si rsnapshot le fait nativement. Juste pour \u00e9viter la confusion. </p> <p>sudo rsnapshot alpha todo : ajouter la config</p>"},{"location":"homeserver/re-partition/#restoration","title":"restoration :","text":"<ul> <li>Dry run sudo rsync -aAXv --delete --dry-run \\   --exclude='/proc/' \\   --exclude='/sys/' \\   --exclude='/dev/' \\   --exclude='/run/' \\   --exclude='/mnt/' \\   --exclude='/media/' \\   --exclude='/swapfile' \\   --exclude='/lost+found/' \\   --exclude='/var/log/' \\   --exclude='/timeshift' \\   /timeshift/alpha.0/localhost/ /</li> <li> <p>Real deal</p> </li> <li> <p>-aAX ensures all permissions, ACLs, and extended attributes are preserved.</p> </li> <li>-v gives you verbose output\u2014you\u2019ll want to watch what happens.</li> <li>--delete removes any files in / that aren\u2019t in the snapshot (so it cleans out yesterday\u2019s chaos).</li> </ul>"},{"location":"homeserver/reverse_proxy/","title":"Reverse proxy","text":"<p>on va utiliser nginx et certbot, tous deux dans un container.  cd tutor ici :  https://mindsers.blog/en/post/https-using-nginx-certbot-docker/</p> <p>on va v\u00e9rifier que la config de l'ensemble {domain, router, firewall, ngix + certbot} fonctionne grace \u00e0 un dry-run :  <code>docker compose run --rm  certbot certonly --webroot --webroot-path /var/www/certbot/ --dry-run -d vps-de-carter.org</code></p> <p>oblig\u00e9 de refaire des certificats aussi pour jellyfin (avec le full docker configur\u00e9 (nginx + certbot)) :  docker compose run --rm certbot certonly --webroot-path /var/www/certbot -d jellyfin.vps-de-carter.org choisir la r\u00e9ponse 2 : \"2: Saves the necessary validation files to a .well-known/acme-challenge/ directory within the nominated webroot path. A separate HTTP server must be running and serving files from the webroot path. HTTP challenge only (wildcards not supported). (webroot)\"</p> <p>on oublie pas de cr\u00e9er le A record pour jellyfin sur le domain provider</p> <p>## jellyfin </p> <p>### Hardware Acceleration   getent group render (le group auquel on doit ajouter jellyfin_user) on doit aussi passer ce group dans le docker compose yml</p> <p>ls -l /dev/dri -&gt; affiche les devices on v\u00e9rifie qu'on abien renderD128   drivers   sudo apt install intel-media-va-driver-non-free libva-utils</p> <p>## certif pour navidrome docker compose run --rm certbot certonly --webroot-path /var/www/certbot -d navidrome.vps-de-carter.org</p>"},{"location":"homeserver/samba/","title":"Samba","text":"<p>sudo apt install samba copie de la config d'origine sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.bak</p> <p>Par d\u00e9fault, Samba utilise ses propres passwords ( pas li\u00e9 aux passwords syst\u00e8me) sudo smbpasswd -a samba_user</p> <p>sudo systemctl enable --now smbd</p> <p>on peut tester samba en local en installant smbclient puis smbclient -L localhost -U samba_user</p> <p>r\u00e8gles firewall pour le lan : TODO : \u00e0 v\u00e9rifer ! peut \u00eatre virer les ports suppl\u00e9mentaires, vu qu'on a pas besoin de la d\u00e9couverte et qu'on utilse pas de vieux systemes.  - TCP 445 \u2192 Direct SMB protocol - UDP 137, 138 \u2192 NetBIOS name resolution &amp; discovery  - TCP 139 \u2192 NetBIOS session service (legacy)</p> <p>sudo ufw allow from 192.168.1.0/24 to any port 445 proto tcp sudo ufw allow from 192.168.1.0/24 to any port 139 proto tcp sudo ufw allow from 192.168.1.0/24 to any port 137,138 proto udp</p>"},{"location":"homeserver/ssh/","title":"SSH","text":""},{"location":"homeserver/ssh/#1-introduction","title":"1. Introduction","text":"<ul> <li>A la fin de l'installation de Debian, nous avons demand\u00e9 l\u2019activation d'un serveur SSH, un protocole de communication indispensable pour piloter la machine \u00e0 distance en mode headless.</li> <li>Ce protocole constituant un point d\u2019entr\u00e9e crucial vers le serveur, il est essentiel d\u2019en limiter et d\u2019en s\u00e9curiser l\u2019acc\u00e8s autant que possible.</li> <li>Cette page couvre la configuration du service SSH c\u00f4t\u00e9 serveur, ainsi que sa s\u00e9curisation : paires de clefs chiffr\u00e9es, r\u00e8gles de firewall, restrictions diverses...</li> <li>On suppose que durant l'installation de Debian, le compte root a bien \u00e9t\u00e9 d\u00e9sactiv\u00e9 au profit d'un nouvel utilisateur avec un mot de passe. </li> </ul>"},{"location":"homeserver/ssh/#2-planification","title":"2. Planification","text":"<p>Lorem ipsum dolor sit amet, (1) consectetur adipiscing elit.</p> <ul> <li>L'objectif principal est qu'\u00e0 la fin de ce tutoriel, l'acc\u00e8s en SSH \u00e0 la machine soit restreint \u00e0 un seul utilisateur, non root, authentifi\u00e9 de fa\u00e7on unique par une clef priv\u00e9e et situ\u00e9 sur le r\u00e9seau local.</li> </ul> <p>Warning</p> <p>La s\u00e9curisation du serveur SSH et de la machine va se faire en plusieures \u00e9tapes, afin de ne pas perdre l'acc\u00e8s par exc\u00e8s de z\u00e8le (et devoir brancher un \u00e9cran et un clavier pour r\u00e9parer).</p> <ul> <li>Objectifs : Quels \u00e9taient vos objectifs pr\u00e9cis pour cette mise en \u0153uvre ?</li> <li>Solutions alternatives envisag\u00e9es (et pourquoi ce choix) : Tr\u00e8s utile pour r\u00e9f\u00e9rence future. Pourquoi avoir choisi <code>mkdocs</code> plut\u00f4t que <code>sphinx</code>, ou l\u2019authentification par cl\u00e9 SSH plut\u00f4t que par mot de passe ?</li> <li>Architecture syst\u00e8me / Sch\u00e9ma r\u00e9seau (si applicable) : Un simple diagramme (utilisable via Mermaid.js dans Material for MkDocs) peut clarifier les configurations complexes.</li> </ul> <p>Lorem ipsum dolor sit amet, (1) consectetur adipiscing elit.</p> <ol> <li>I'm an annotation! I can contain <code>code</code>, formatted     text, images, ... basically anything that can be expressed in Markdown.</li> </ol>"},{"location":"homeserver/ssh/#3-etapes-de-mise-en-uvre","title":"3. \u00c9tapes de mise en \u0153uvre","text":"<p>Cette section doit \u00eatre un tutoriel clair et progressif. Chaque \u00e9tape contient un objectif et les commandes n\u00e9cessaires.</p>"},{"location":"homeserver/ssh/#31-sous-sujet-1-par-ex-installation-des-paquets-necessaires","title":"3.1. [Sous-sujet 1 : par ex., Installation des paquets n\u00e9cessaires]","text":"<ul> <li>Objectif : Que cherchez-vous \u00e0 accomplir \u00e0 cette \u00e9tape ?</li> <li>Explication : Pourquoi ces paquets sont-ils n\u00e9cessaires ? Que font ces commandes ?</li> <li>Commandes : Utilisez des blocs de code avec coloration syntaxique. Pr\u00e9cisez si des droits root sont requis.     <pre><code>sudo apt update\nsudo apt install &lt;nom-du-paquet&gt; # Pourquoi ce paquet est requis\n</code></pre></li> <li>Sortie attendue (optionnel mais utile) : Affichez un extrait ou un exemple de la sortie attendue pour guider le lecteur.     <pre><code>Exemple de sortie...\n</code></pre></li> <li>Remarques / D\u00e9pannage : Consid\u00e9rations sp\u00e9cifiques, probl\u00e8mes fr\u00e9quents, ou astuces utiles.</li> </ul>"},{"location":"homeserver/ssh/#32-sous-sujet-2-par-ex-configuration","title":"3.2. [Sous-sujet 2 : par ex., Configuration]","text":"<ul> <li>Objectif : Quelle configuration mettez-vous en place ?</li> <li>Explication : Pr\u00e9cisez le r\u00f4le des fichiers de configuration, les param\u00e8tres sp\u00e9cifiques et leurs effets.</li> <li>Commandes (\u00e9dition de fichiers) : <pre><code>sudo nano /etc/config/fichier.conf\n</code></pre></li> <li>Contenu du fichier (utiliser un bloc code avec <code>linenums</code> et <code>hl_lines</code>) : <pre><code># Exemple de fichier de configuration\n[Section]\nParametre1 = valeur1\n# Cette ligne est importante\nParametre2 = valeur2 # Cette valeur permet de faire X\nAutreParam = 0\n# Activer ceci pour Y\nEncoreUn = true\n</code></pre></li> <li>Commandes de validation (ex. : <code>systemctl status</code>) : <pre><code>systemctl status nom-du-service\n</code></pre></li> <li>Sortie attendue : <pre><code>\u25cf nom-du-service.service - Description\n     Charg\u00e9 : charg\u00e9 (/lib/systemd/system/nom-du-service.service; activ\u00e9; preset : activ\u00e9)\n     Actif : actif (en fonctionnement) depuis ...\n</code></pre></li> <li>Remarques / D\u00e9pannage : Comme ci-dessus, partagez vos r\u00e9flexions ou pi\u00e8ges courants.</li> </ul>"},{"location":"homeserver/ssh/#4-verification-tests","title":"4. V\u00e9rification / Tests","text":"<ul> <li>Comment v\u00e9rifier que tout fonctionne : Commandes ou \u00e9tapes de test.     <pre><code>ssh utilisateur@ip-du-serveur # Pour tester la connexion SSH\n</code></pre></li> <li>R\u00e9sultat attendu : Que devrait-on voir ou constater si tout fonctionne correctement ?</li> </ul>"},{"location":"homeserver/ssh/#5-utilisation-quotidienne-si-applicable","title":"5. Utilisation quotidienne (si applicable)","text":"<ul> <li>Commandes courantes : Pour les op\u00e9rations quotidiennes (ex. : consulter les logs SSH, ajouter une cl\u00e9).     <pre><code>journalctl -u sshd.service\n</code></pre></li> <li>Astuces : Bonnes pratiques, raccourcis utiles, etc.</li> </ul>"},{"location":"homeserver/ssh/#6-maintenance-evolutions-futures","title":"6. Maintenance / \u00c9volutions futures","text":"<ul> <li>Sauvegardes : Comment sauvegarder les fichiers ou configurations importants.</li> <li>Mises \u00e0 jour du service / paquet : Comment assurer le suivi et la mise \u00e0 jour.</li> <li>Probl\u00e8mes potentiels : Probl\u00e8mes pr\u00e9visibles et solutions associ\u00e9es.</li> <li>\u00c9volutivit\u00e9 / Am\u00e9liorations futures : Pistes d\u2019\u00e9volution, d\u2019optimisation ou d\u2019extension.</li> </ul>"},{"location":"homeserver/ssh/#7-ressources-liens-utiles","title":"7. Ressources / Liens utiles","text":"<ul> <li>Documentation officielle : Man pages, docs officielles du projet, etc.</li> <li>Articles / tutoriels pertinents : Sources externes ayant aid\u00e9.</li> <li>Pages li\u00e9es : Liens vers d\u2019autres pages de votre propre documentation.</li> </ul>"},{"location":"homeserver/ssh/#8-journal-des-modifications","title":"8. Journal des modifications","text":"<ul> <li>Date : Modifications apport\u00e9es.<ul> <li>27-06-2025 : Application du pattern.</li> </ul> </li> </ul> <p>But s\u00e9curiser l'acc\u00e8s en ssh.  </p> <p>on peut cr\u00e9er une paire de cl\u00e9s publiques/priv\u00e9es</p> <p>On se co en ssh avec password avec le compte cr\u00e9\u00e9 durant l'install Powershell<pre><code>ssh carter@ps-de-carter\n</code></pre></p>"},{"location":"homeserver/ssh/#private-public-keys","title":"Private / Public Keys","text":""},{"location":"homeserver/ssh/#preparation-cote-linux","title":"Pr\u00e9paration c\u00f4t\u00e9 linux","text":"<p>Cr\u00e9a du dossier \u00e0 l'emplacement classique (dans le dossier utilisateur, l\u00e0 o\u00f9 ssh va chercher les clefs) Bash<pre><code>mkdir -p ~/.ssh\ntouch ~/.ssh/authorized_keys\n</code></pre> Gestion des permissions. /!\\ le dossier ET le fichiers doivent appartenir \u00e0 l'utilisateur Bash<pre><code>chmod 700 ~/.ssh\nchmod 600 ~/.ssh/authorized_keys\n</code></pre> A la fin, on doit obtenir \u00e7a :  </p>"},{"location":"homeserver/ssh/#crea-des-clefs-sous-windows","title":"Cr\u00e9a des clefs sous windows","text":"<p>openSSH est d\u00e9j\u00e0 install\u00e9 sur windows 11, on peut donc l'utiliser pour g\u00e9n\u00e9rer les paires de clefs. Powershell<pre><code>ssh-keygen -t ed25519 -C \"sp9-de-carter\"\n</code></pre> On enregistre sur place (.ssh) \u00e0 cot\u00e9 du fichier host, sans passphrase. On se retrouve avec 2 fichiers id_ed25519 et id_ed25519.pub (la clef publique)</p> <p>Si on veut des clefs sur une autre machine, ne pas oublier de changer le label.</p>"},{"location":"homeserver/ssh/#copie-des-clefs-dans-authorized_keys","title":"Copie des clefs dans authorized_keys","text":"<p>copie directe depuis windows, <code>&gt;&gt;</code> concat\u00e8ne donc pas de soucis pour rajouter des clefs suppl\u00e9mentaries avec la m\u00eame commande.</p> Powershell<pre><code>type $env:USERPROFILE\\.ssh\\id_ed25519.pub | ssh carter@ps-de-carter \"cat &gt;&gt; .ssh/authorized_keys\"\n</code></pre> <p>On peut sinon, ouvrir le fichier .pub, copier le contenu et le coller dans la fentre de terminal apr\u00e8s avoir ouvert authorized_keys avec nano.</p>"},{"location":"homeserver/ssh/#activation-et-test","title":"Activation et Test","text":"<p>Pour pouvoir se co avec des clefs publiques uniquement il faut editer le fichier de config du server ssh.</p> Bash<pre><code>sudo nano /etc/ssh/sshd_config\n</code></pre> <p>On va activer les lignes suivantes (en enlevant le <code>#</code> de commentaire)</p> sshd_config<pre><code>PubkeyAuthentication yes\nAuthorizedKeysFile .ssh/authorized_keys\n</code></pre> <p>On red\u00e9marre le service Bash<pre><code>sudo systemctl restart ssh\n</code></pre></p> <p>Si on peut se co sans mettre de password avec juste <code>ssh carter@ps-de-carter</code> alors l'authentification par clefs fonctionne et on peut passer \u00e0 la suite.</p>"},{"location":"homeserver/ssh/#ip-fixe","title":"IP Fixe","text":"<p>Si le server est bien en ip fixe, on peut restreindre ssh a cette seule interface.</p> <p>Mais, l'obtention d'une IP fixe par le router n'est pas suffisante (peut arriver trop tard) ; de plus si on confie le service DHCP \u00e0 pi-hole plus tard on devra aussi d\u00e9clarer une IP fixe.  </p> <p>Donc on modifie les interfaces pour passer en static. Bash<pre><code>sudo nano /etc/network/interfaces\n</code></pre> interfaces<pre><code># apr\u00e8s 'allow-hotplug enp0s31f6'\n# remplacer 'iface enp0s31f6 inet dhcp' par\niface enp0s31f6 inet static\n    address 192.168.1.69\n    netmask 255.255.255.0\n    gateway 192.168.1.1\n    dns-nameservers 1.1.1.1 8.8.8.8\n</code></pre> Attention aux valeurs r\u00e9elles des interfaces et IPs !</p>"},{"location":"homeserver/ssh/#config","title":"Config","text":"<p>On peut continuer l'\u00e9dition de <code>sshd_config</code>. Maintenant qu'on sait que les clefs fonctionnent, on va virer la co par password.</p> sshd_config<pre><code>PasswordAuthentication no\nPermitRootLogin no\nKbdInteractiveAuthentication no # anciennement ChallengeResponseAuthentication\nUsePAM no\n# le server est en ip fixe et on ne veut pas qu'il \u00e9coute sur une autre interface\nListenAddress 192.168.1.69\n# On pourrait vouloir rajouter une interface pour les acc\u00e8s via wireguard\n# ListenAddress 10.qqchose\n# attention au changement de num de port !\nPort 2357\n</code></pre> <p>On restart et on teste, il faut mainteantn pr\u00e9ciser le num de port pour se co. Powershell<pre><code>ssh -p 2357 carter@ps-de-carter\n</code></pre></p> <p>Next : Hardening part 1</p>"}]}